<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Room Finder - Easy Room Search</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .auth-section {
            background: rgba(255, 255, 255, 0.15);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
            max-width: 450px;
            margin-left: auto;
            margin-right: auto;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 25px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .auth-tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: transparent;
            color: rgba(255, 255, 255, 0.7);
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .auth-tab.active {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: white;
            font-size: 14px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.8);
            background: rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        .form-group select {
            color: #333;
        }

        .form-group select option {
            color: #333;
            background: white;
        }

        .btn {
            width: 100%;
            padding: 15px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.3);
            box-shadow: 0 5px 15px rgba(255, 255, 255, 0.2);
        }

        .btn:disabled {
            background: rgba(255, 255, 255, 0.1);
            cursor: not-allowed;
            transform: none;
        }

        .main-content {
            display: none;
        }

        .main-content.show {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tabs {
            display: flex;
            background: white;
            border-radius: 15px 15px 0 0;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .tab {
            flex: 1;
            padding: 18px 25px;
            text-align: center;
            cursor: pointer;
            background: #f8f9fa;
            transition: all 0.3s ease;
            border: none;
            font-size: 16px;
            font-weight: bold;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab:hover:not(.active) {
            background: #e9ecef;
        }

        .tab-content {
            background: white;
            padding: 30px;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            min-height: 500px;
        }

        .room-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .room-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .room-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        .room-card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.4rem;
            font-weight: bold;
        }

        .room-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .room-detail {
            background: rgba(102, 126, 234, 0.05);
            padding: 12px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .room-detail strong {
            color: #333;
            display: block;
            margin-bottom: 4px;
            font-size: 14px;
        }

        .room-detail span {
            color: #666;
            font-size: 16px;
        }

        .room-description {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #28a745;
        }

        .room-description strong {
            color: #333;
            display: block;
            margin-bottom: 8px;
        }

        .contact-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .contact-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);
        }

        .landlord-form {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid #e9ecef;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .landlord-form .form-group label {
            color: #333;
        }

        .landlord-form .form-group input,
        .landlord-form .form-group select,
        .landlord-form .form-group textarea {
            background: #fafafa;
            border: 2px solid #e0e0e0;
            color: #333;
        }

        .landlord-form .form-group input::placeholder,
        .landlord-form .form-group textarea::placeholder {
            color: #666;
        }

        .landlord-form .form-group input:focus,
        .landlord-form .form-group select:focus,
        .landlord-form .form-group textarea:focus {
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.2);
        }

        .landlord-form .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }

        .room-actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .edit-btn {
            background: linear-gradient(135deg, #ffc107 0%, #ffdb4d 100%);
            color: #212529;
            font-weight: bold;
        }

        .delete-btn {
            background: linear-gradient(135deg, #dc3545 0%, #ff6b7a 100%);
            color: white;
            font-weight: bold;
        }

        .edit-btn,
        .delete-btn {
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .edit-btn:hover,
        .delete-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .search-filters {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 1px solid #e9ecef;
        }

        .search-filters .form-group label {
            color: #333;
        }

        .search-filters .form-group input,
        .search-filters .form-group select {
            background: #fafafa;
            border: 2px solid #e0e0e0;
            color: #333;
        }

        .search-filters .form-group input::placeholder {
            color: #666;
        }

        .search-filters .form-group input:focus,
        .search-filters .form-group select:focus {
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.2);
        }

        .search-filters .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .hidden {
            display: none !important;
        }

        .user-info {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            background: rgba(255, 255, 255, 0.2);
            padding: 12px 20px;
            border-radius: 25px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .logout-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            margin-left: 10px;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: #c82333;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #c3e6cb;
            display: none;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #f5c6cb;
            display: none;
        }

        .room-count {
            background: linear-gradient(135deg, #17a2b8 0%, #20c997 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
            font-size: 16px;
        }

        .password-strength {
            font-size: 12px;
            margin-top: 5px;
            color: rgba(255, 255, 255, 0.8);
        }

        .password-strength.weak {
            color: #ff6b6b;
        }

        .password-strength.medium {
            color: #ffd93d;
        }

        .password-strength.strong {
            color: #6bcf7f;
        }

        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            color: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .dashboard-card h3 {
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .dashboard-card .number {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 15px 0;
        }

        .dashboard-card p {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .quick-filter-btn {
            transition: all 0.3s ease;
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            margin: 5px;
        }

        .quick-filter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .no-rooms {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .no-rooms h3 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: #333;
        }

        .no-rooms p {
            font-size: 1.1rem;
            margin-bottom: 25px;
        }

        @media (max-width: 768px) {
            .dashboard-cards {
                grid-template-columns: 1fr;
            }

            .filter-row {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .room-details {
                grid-template-columns: 1fr;
            }

            .user-info {
                position: static;
                margin-bottom: 20px;
                text-align: center;
            }
        }

        .stats-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .rent-card {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .activity-card {
            background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
        }

        .rooms-card {
            background: linear-gradient(135deg, #17a2b8 0%, #20c997 100%);
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="user-info hidden" id="userInfo">
            <span id="userName"></span>
            <span id="userType"></span>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>

        <div class="header">
            <h1>üè† Room Finder</h1>
            <p>Find or rent rooms easily in Lucknow</p>
        </div>

        <div class="auth-section" id="authSection">
            <div class="auth-tabs">
                <button class="auth-tab active" id="loginTab" onclick="switchAuthTab('login')">Login</button>
                <button class="auth-tab" id="registerTab" onclick="switchAuthTab('register')">Register</button>
            </div>

            <div id="loginSection">
                <h2 style="text-align: center; margin-bottom: 20px; color: white;">Login to Your Account</h2>
                <div class="form-group">
                    <label for="loginUsername">üë§ Username</label>
                    <input type="text" id="loginUsername" placeholder="Enter your username" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">üîí Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password" required>
                </div>
                <button class="btn" onclick="loginUser()">Login</button>
                <div style="text-align: center; margin-top: 15px; color: rgba(255,255,255,0.8); font-size: 14px;">
                    Demo: Username: <strong>admin</strong>, Password: <strong>admin123</strong>
                </div>
            </div>

            <div id="registerSection" class="hidden">
                <h2 style="text-align: center; margin-bottom: 20px; color: white;">Create New Account</h2>
                <div class="form-group">
                    <label for="registerName">üë§ Full Name</label>
                    <input type="text" id="registerName" placeholder="Enter your full name" required>
                </div>
                <div class="form-group">
                    <label for="registerUsername">üë§ Username</label>
                    <input type="text" id="registerUsername" placeholder="Choose a username" required>
                </div>
                <div class="form-group">
                    <label for="registerPhone">üì± Mobile Number</label>
                    <input type="tel" id="registerPhone" placeholder="10 digit mobile number" maxlength="10" required>
                </div>
                <div class="form-group">
                    <label for="registerEmail">üìß Email</label>
                    <input type="email" id="registerEmail" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label for="registerPassword">üîí Password</label>
                    <input type="password" id="registerPassword" placeholder="Create a strong password" required>
                    <div id="passwordStrength" class="password-strength"></div>
                </div>
                <div class="form-group">
                    <label for="confirmPassword">üîí Confirm Password</label>
                    <input type="password" id="confirmPassword" placeholder="Confirm your password" required>
                </div>
                <div class="form-group">
                    <label for="userTypeSelect">üë§ Account Type</label>
                    <select id="userTypeSelect" required>
                        <option value="">Select Account Type</option>
                        <option value="student">Student (Looking for rooms)</option>
                        <option value="landlord">Landlord (Want to rent rooms)</option>
                    </select>
                </div>
                <button class="btn" onclick="registerUser()">Create Account</button>
            </div>
        </div>

        <div class="main-content" id="mainContent">
            <div class="tabs">
                <button class="tab active" id="studentTab" onclick="showTab('student')">üéì Find Rooms</button>
                <button class="tab" id="landlordTab" onclick="showTab('landlord')">üè† Manage Rooms</button>
            </div>

            <div class="tab-content">
                <div id="successMessage" class="success-message"></div>
                <div id="errorMessage" class="error-message"></div>

                <div id="studentSection">
                    <!-- Student Dashboard -->
                    <div class="dashboard-cards">
                        <div class="dashboard-card stats-card">
                            <h3>üè† Available Rooms</h3>
                            <div class="number" id="totalRoomsCard">0</div>
                            <p>Ready to rent</p>
                        </div>
                        <div class="dashboard-card rent-card">
                            <h3>üí∞ Average Rent</h3>
                            <div class="number" id="avgRentCard">‚Çπ0</div>
                            <p>Per month</p>
                        </div>
                        <div class="dashboard-card activity-card">
                            <h3>üîç Last Search</h3>
                            <div style="font-size: 1.2rem; font-weight: bold; margin: 15px 0;" id="lastSearchCard">No
                                searches</div>
                            <p>Your recent activity</p>
                        </div>
                    </div>

                    <!-- Search Filters -->
                    <div class="search-filters">
                        <h3 style="margin-bottom: 20px; color: #333;">üîç Search Rooms</h3>
                        <div class="filter-row">
                            <div class="form-group">
                                <label>üìç Location</label>
                                <input type="text" id="searchLocation" placeholder="Hazratganj, Gomti Nagar, etc.">
                            </div>
                            <div class="form-group">
                                <label>üí∞ Max Rent (‚Çπ)</label>
                                <input type="number" id="maxRent" placeholder="Maximum rent budget">
                            </div>
                            <div class="form-group">
                                <label>üè† Room Type</label>
                                <select id="roomTypeFilter">
                                    <option value="">All Room Types</option>
                                    <option value="single">Single Room</option>
                                    <option value="sharing">Sharing Room</option>
                                    <option value="1bhk">1BHK</option>
                                    <option value="2bhk">2BHK</option>
                                    <option value="3bhk">3BHK</option>
                                </select>
                            </div>
                        </div>
                        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                            <button class="btn" style="width: auto; padding: 12px 30px;" onclick="searchRooms()">
                                üîç Search Rooms
                            </button>
                            <button class="btn" style="width: auto; padding: 12px 30px; background: #6c757d;"
                                onclick="clearFilters()">
                                üóëÔ∏è Clear Filters
                            </button>
                            <button class="btn" style="width: auto; padding: 12px 30px; background: #28a745;"
                                onclick="showAllRooms()">
                                üìã Show All Rooms
                            </button>
                        </div>
                    </div>

                    <!-- Quick Filters -->
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 15px; margin-bottom: 25px;">
                        <h4 style="margin-bottom: 15px; color: #333;">‚ö° Quick Filters</h4>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button class="quick-filter-btn" onclick="quickFilter('budget')"
                                style="background: #28a745; color: white;">
                                üí∞ Budget Friendly (Under ‚Çπ10,000)
                            </button>
                            <button class="quick-filter-btn" onclick="quickFilter('premium')"
                                style="background: #dc3545; color: white;">
                                ‚≠ê Premium (Gomti Nagar Area)
                            </button>
                            <button class="quick-filter-btn" onclick="quickFilter('sharing')"
                                style="background: #17a2b8; color: white;">
                                üë• Sharing Rooms
                            </button>
                            <button class="quick-filter-btn" onclick="quickFilter('single')"
                                style="background: #ffc107; color: #333;">
                                üè† Single Rooms
                            </button>
                            <button class="quick-filter-btn" onclick="quickFilter('students')"
                                style="background: #6f42c1; color: white;">
                                üéì Student Areas
                            </button>
                        </div>
                    </div>

                    <!-- Room Listings -->
                    <div id="roomsList">
                        <div class="room-count" id="roomCount">Loading rooms...</div>
                        <div id="roomsContainer"></div>
                    </div>
                </div>

                <div id="landlordSection" class="hidden">
                    <!-- Landlord Dashboard -->
                    <div class="dashboard-cards">
                        <div class="dashboard-card stats-card">
                            <h3>üè† My Rooms</h3>
                            <div class="number" id="myRoomsCard">0</div>
                            <p>Currently listed</p>
                        </div>
                        <div class="dashboard-card rent-card">
                            <h3>üìà Total Views</h3>
                            <div class="number" id="totalViewsCard">0</div>
                            <p>Room inquiries</p>
                        </div>
                        <div class="dashboard-card activity-card">
                            <h3>üí∞ Avg Rent</h3>
                            <div class="number" id="landlordAvgRentCard">‚Çπ0</div>
                            <p>Your properties</p>
                        </div>
                    </div>

                    <!-- Room Form -->
                    <div class="landlord-form">
                        <h3 style="margin-bottom: 25px; color: #333;" id="formTitle">‚ûï Add New Room</h3>

                        <form id="roomForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>üè∑Ô∏è Room Title *</label>
                                    <input type="text" name="title" required
                                        placeholder="e.g. Beautiful 2BHK in Gomti Nagar">
                                </div>
                                <div class="form-group">
                                    <label>üí∞ Monthly Rent (‚Çπ) *</label>
                                    <input type="number" name="rent" required placeholder="e.g. 15000">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>üè† Room Type *</label>
                                    <select name="roomType" required>
                                        <option value="">Select Room Type</option>
                                        <option value="single">Single Room</option>
                                        <option value="sharing">Sharing Room</option>
                                        <option value="1bhk">1BHK</option>
                                        <option value="2bhk">2BHK</option>
                                        <option value="3bhk">3BHK</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>üìû Contact Number *</label>
                                    <input type="tel" name="contact" required placeholder="WhatsApp number preferred">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>üìç Complete Location *</label>
                                    <input type="text" name="location" required
                                        placeholder="Full address - Area, City, State">
                                </div>
                                <div class="form-group">
                                    <label>‚ú® Amenities</label>
                                    <input type="text" name="amenities" placeholder="Wi-Fi, AC, Parking, Kitchen etc">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>üìù Detailed Description *</label>
                                <textarea name="description" class="textarea" required
                                    placeholder="Describe your room in detail - size, facilities, nearby places, rules, etc."></textarea>
                            </div>
                            <button type="submit" class="btn" id="formSubmitBtn">
                                <span id="formButtonText">‚úÖ Add Room</span>
                            </button>
                        </form>
                    </div>

                    <!-- My Rooms -->
                    <div id="myRoomsList">
                        <div class="room-count" id="myRoomCount">Loading your rooms...</div>
                        <h3 style="color: #333; margin-bottom: 20px;">üè† My Property Listings</h3>
                        <div id="myRoomsContainer"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentUser = null;
        let users = [];
        let rooms = [];
        let editingRoomId = null;
        let lastSearch = null;

        // Sample data with more realistic Lucknow locations
        const sampleUsers = [
            {
                username: 'admin',
                password: 'admin123',
                name: 'Admin User',
                phone: '9999999999',
                email: 'admin@roomfinder.com',
                type: 'landlord'
            },
            {
                username: 'student1',
                password: 'student123',
                name: 'Rahul Kumar',
                phone: '8888888888',
                email: 'rahul@gmail.com',
                type: 'student'
            },
            {
                username: 'landlord1',
                password: 'land123',
                name: 'Priya Sharma',
                phone: '7777777777',
                email: 'priya@gmail.com',
                type: 'landlord'
            }
        ];

        const sampleRooms = [
            {
                id: 1,
                title: "Luxury Single Room in Hazratganj",
                rent: 12000,
                location: "Hazratganj Main Road, Near GPO, Lucknow, UP",
                roomType: "single",
                contact: "9876543210",
                amenities: "Wi-Fi, AC, Attached Bathroom, CCTV, 24x7 Security",
                description: "Beautiful single room in prime location of Hazratganj. All modern amenities available. Very close to GPO and Metro station. Ideal for working professionals. Fully furnished with bed, study table, wardrobe. Pure vegetarian tenants preferred.",
                ownerUsername: "admin",
                dateAdded: new Date().toLocaleDateString('en-IN')
            },
            {
                id: 2,
                title: "Student Sharing Room Near IT College",
                rent: 6500,
                location: "Indira Nagar Extension, Near BBDNIIT, Lucknow, UP",
                roomType: "sharing",
                contact: "8765432109",
                amenities: "Wi-Fi, Food Available, Study Table, Laundry, Parking",
                description: "Perfect sharing room very close to IT college and engineering institutes. Ideal for students. Mess facility available with home-cooked food. Library and market also nearby. 2 students per room. Study environment maintained.",
                ownerUsername: "admin",
                dateAdded: new Date().toLocaleDateString('en-IN')
            },
            {
                id: 3,
                title: "Fully Furnished 2BHK Premium Apartment",
                rent: 25000,
                location: "Gomti Nagar Extension, Sector 5, Near Phoenix Mall, Lucknow, UP",
                roomType: "2bhk",
                contact: "7654321098",
                amenities: "Fully Furnished, AC, Modular Kitchen, Gym, Swimming Pool, Elevator, Parking",
                description: "Luxury 2BHK apartment in premium Gomti Nagar location. Just 2 minutes from Phoenix Mall and 5 minutes from Metro station. All modern amenities included. Perfect for family or working couple. Gated society with 24x7 security.",
                ownerUsername: "admin",
                dateAdded: new Date().toLocaleDateString('en-IN')
            },
            {
                id: 4,
                title: "Budget 1BHK Near Railway Station",
                rent: 8500,
                location: "Charbagh, Near Lucknow Junction Railway Station, Lucknow, UP",
                roomType: "1bhk",
                contact: "9988776655",
                amenities: "Semi-Furnished, Fan, Basic Kitchen, 24x7 Water Supply",
                description: "Affordable 1BHK near main railway station. No transportation issues as all city buses and autos easily available. Good connectivity to all parts of Lucknow. Basic furnishing included. Suitable for working professionals and small families.",
                ownerUsername: "landlord1",
                dateAdded: new Date().toLocaleDateString('en-IN')
            },
            {
                id: 5,
                title: "PG for Girls - Alambagh Area",
                rent: 7000,
                location: "Alambagh Bus Stand, Near Munshi Pulia, Lucknow, UP",
                roomType: "sharing",
                contact: "9123456789",
                amenities: "WiFi, Food, Laundry, Security, AC, Study Room",
                description: "Safe and secure PG accommodation for girls only. Homely environment with nutritious meals. Study room and Wi-Fi facility available. Near coaching institutes and colleges. Strict timings maintained for safety. Monthly rent includes food and all facilities.",
                ownerUsername: "admin",
                dateAdded: new Date().toLocaleDateString('en-IN')
            },
            {
                id: 6,
                title: "3BHK Independent House - Aliganj",
                rent: 18000,
                location: "Aliganj Sector C, Near CMS School, Lucknow, UP",
                roomType: "3bhk",
                contact: "8765432198",
                amenities: "Independent House, Parking, Garden, Bore Well Water, Power Backup",
                description: "Spacious 3BHK independent house in peaceful Aliganj area. Perfect for families. Has small garden and parking space for 2 vehicles. Good water supply and power backup. Near reputed schools and hospitals. Vegetarian family preferred.",
                ownerUsername: "landlord1",
                dateAdded: new Date().toLocaleDateString('en-IN')
            }
        ];

        // Initialize app
        document.addEventListener('DOMContentLoaded', function () {
            console.log('App initializing...');
            users = [...sampleUsers];
            rooms = [...sampleRooms];

            // Initialize display
            displayRooms();
            updateRoomCount();

            // Add password strength checker
            const passwordField = document.getElementById('registerPassword');
            if (passwordField) {
                passwordField.addEventListener('input', checkPasswordStrength);
            }

            // Enter key handlers
            document.getElementById('loginPassword').addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    loginUser();
                }
            });

            document.getElementById('confirmPassword').addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    registerUser();
                }
            });

            console.log('App initialized successfully');
        });

        function updateDashboard() {
            if (!currentUser) return;

            if (currentUser.type === 'student') {
                updateStudentDashboard();
            } else {
                updateLandlordDashboard();
            }
        }

        function updateStudentDashboard() {
            const totalRooms = rooms.length;
            const avgRent = rooms.length > 0 ? Math.round(rooms.reduce((sum, room) => sum + room.rent, 0) / rooms.length) : 0;

            document.getElementById('totalRoomsCard').textContent = totalRooms;
            document.getElementById('avgRentCard').textContent = `‚Çπ${avgRent.toLocaleString()}`;
            document.getElementById('lastSearchCard').textContent = lastSearch || 'No searches yet';
        }

        function updateLandlordDashboard() {
            const myRooms = rooms.filter(room => room.ownerUsername === currentUser.username);
            const totalViews = myRooms.length * Math.floor(Math.random() * 50) + 10;
            const avgRent = myRooms.length > 0 ? Math.round(myRooms.reduce((sum, room) => sum + room.rent, 0) / myRooms.length) : 0;

            document.getElementById('myRoomsCard').textContent = myRooms.length;
            document.getElementById('totalViewsCard').textContent = totalViews;
            document.getElementById('landlordAvgRentCard').textContent = `‚Çπ${avgRent.toLocaleString()}`;
        }

        function switchAuthTab(tab) {
            document.getElementById('loginTab').classList.toggle('active', tab === 'login');
            document.getElementById('registerTab').classList.toggle('active', tab === 'register');

            document.getElementById('loginSection').classList.toggle('hidden', tab !== 'login');
            document.getElementById('registerSection').classList.toggle('hidden', tab !== 'register');

            // Clear form fields
            if (tab === 'login') {
                document.getElementById('loginUsername').value = '';
                document.getElementById('loginPassword').value = '';
            } else {
                document.getElementById('registerName').value = '';
                document.getElementById('registerUsername').value = '';
                document.getElementById('registerPhone').value = '';
                document.getElementById('registerEmail').value = '';
                document.getElementById('registerPassword').value = '';
                document.getElementById('confirmPassword').value = '';
                document.getElementById('userTypeSelect').value = '';
                document.getElementById('passwordStrength').textContent = '';
            }
        }

        function checkPasswordStrength() {
            const password = document.getElementById('registerPassword').value;
            const strengthEl = document.getElementById('passwordStrength');

            if (password.length === 0) {
                strengthEl.textContent = '';
                return;
            }

            let strength = 0;
            let message = '';

            if (password.length >= 8) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[a-z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[^A-Za-z0-9]/.test(password)) strength++;

            switch (strength) {
                case 0:
                case 1:
                    message = 'Weak password - Add numbers & capital letters';
                    strengthEl.className = 'password-strength weak';
                    break;
                case 2:
                case 3:
                    message = 'Medium password - Good to go!';
                    strengthEl.className = 'password-strength medium';
                    break;
                case 4:
                case 5:
                    message = 'Strong password - Excellent!';
                    strengthEl.className = 'password-strength strong';
                    break;
            }

            strengthEl.textContent = message;
        }

        function registerUser() {
            const name = document.getElementById('registerName').value.trim();
            const username = document.getElementById('registerUsername').value.trim();
            const phone = document.getElementById('registerPhone').value.trim();
            const email = document.getElementById('registerEmail').value.trim();
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const userType = document.getElementById('userTypeSelect').value;

            // Validation
            if (!name || name.length < 2) {
                showMessage('Full name must be at least 2 characters long', true);
                return;
            }

            if (!username || username.length < 3) {
                showMessage('Username must be at least 3 characters long', true);
                return;
            }

            if (users.find(u => u.username === username)) {
                showMessage('Username already exists. Please choose a different one.', true);
                return;
            }

            if (!phone || !/^\d{10}$/.test(phone)) {
                showMessage('Please enter a valid 10-digit mobile number', true);
                return;
            }

            if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                showMessage('Please enter a valid email address', true);
                return;
            }

            if (!password || password.length < 6) {
                showMessage('Password must be at least 6 characters long', true);
                return;
            }

            if (password !== confirmPassword) {
                showMessage('Passwords do not match', true);
                return;
            }

            if (!userType) {
                showMessage('Please select an account type', true);
                return;
            }

            // Create new user
            const newUser = {
                username: username,
                password: password,
                name: name,
                phone: phone,
                email: email,
                type: userType
            };

            users.push(newUser);
            showMessage('üéâ Account created successfully! You can now login.');

            // Auto switch to login tab
            setTimeout(() => {
                switchAuthTab('login');
                document.getElementById('loginUsername').value = username;
            }, 1500);
        }

        function loginUser() {
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value;

            if (!username) {
                showMessage('Please enter your username', true);
                return;
            }

            if (!password) {
                showMessage('Please enter your password', true);
                return;
            }

            const user = users.find(u => u.username === username);

            if (!user) {
                showMessage('Username not found. Please check your username or register first.', true);
                return;
            }

            if (user.password !== password) {
                showMessage('Incorrect password. Please try again.', true);
                return;
            }

            // Login successful
            currentUser = user;

            // Hide auth and show main content with animation
            document.getElementById('authSection').classList.add('hidden');
            const mainContent = document.getElementById('mainContent');
            mainContent.classList.remove('hidden');
            mainContent.classList.add('show');
            document.getElementById('userInfo').classList.remove('hidden');

            // Update user info
            document.getElementById('userName').textContent = user.name;
            document.getElementById('userType').textContent = user.type === 'student' ? '(Student)' : '(Landlord)';

            // Show appropriate tab
            if (user.type === 'student') {
                document.getElementById('landlordTab').style.display = 'none';
                showTab('student');
            } else {
                document.getElementById('landlordTab').style.display = 'block';
                showTab('landlord');
                loadMyRooms();
            }

            updateDashboard();
            displayRooms();
            updateRoomCount();
            showMessage(`üéâ Welcome back, ${user.name}! Login successful.`);
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                currentUser = null;
                editingRoomId = null;

                document.getElementById('authSection').classList.remove('hidden');
                document.getElementById('mainContent').classList.add('hidden');
                document.getElementById('mainContent').classList.remove('show');
                document.getElementById('userInfo').classList.add('hidden');

                // Reset forms
                switchAuthTab('login');
                document.getElementById('roomForm').reset();
                document.getElementById('formButtonText').textContent = '‚úÖ Add Room';
                document.getElementById('formTitle').textContent = '‚ûï Add New Room';

                showMessage('üëã Successfully logged out.');
            }
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabName + 'Tab').classList.add('active');

            document.getElementById('studentSection').classList.toggle('hidden', tabName !== 'student');
            document.getElementById('landlordSection').classList.toggle('hidden', tabName !== 'landlord');

            if (tabName === 'student') {
                displayRooms();
                updateRoomCount();
            } else {
                loadMyRooms();
                updateRoomCount();
            }

            updateDashboard();
        }

        function updateRoomCount() {
            const totalRooms = rooms.length;
            document.getElementById('roomCount').textContent = `üìã Total ${totalRooms} rooms available for rent`;

            if (currentUser && currentUser.type === 'landlord') {
                const myRooms = rooms.filter(room => room.ownerUsername === currentUser.username).length;
                document.getElementById('myRoomCount').textContent = `üè† You have ${myRooms} rooms listed`;
            }
        }

        function displayRooms(filteredRooms = null) {
            const container = document.getElementById('roomsContainer');
            const roomsToShow = filteredRooms || rooms;

            if (roomsToShow.length === 0) {
                container.innerHTML = `
                    <div class="no-rooms">
                        <h3>üòî No rooms found</h3>
                        <p>Try changing your search criteria or check back later</p>
                        <button class="btn" onclick="clearFilters()" style="width: auto; padding: 12px 30px; margin-top: 15px;">
                            üîÑ Reset Filters
                        </button>
                    </div>
                `;
                return;
            }

            container.innerHTML = roomsToShow.map(room => `
                <div class="room-card">
                    <h3>${room.title}</h3>
                    <div class="room-details">
                        <div class="room-detail">
                            <strong>üí∞ Monthly Rent:</strong>
                            <span>‚Çπ${room.rent.toLocaleString()}/month</span>
                        </div>
                        <div class="room-detail">
                            <strong>üìç Location:</strong>
                            <span>${room.location}</span>
                        </div>
                        <div class="room-detail">
                            <strong>üè† Room Type:</strong>
                            <span>${getRoomTypeDisplay(room.roomType)}</span>
                        </div>
                        <div class="room-detail">
                            <strong>üìû Contact:</strong>
                            <span>${room.contact}</span>
                        </div>
                        <div class="room-detail">
                            <strong>‚ú® Amenities:</strong>
                            <span>${room.amenities || 'Basic facilities'}</span>
                        </div>
                        <div class="room-detail">
                            <strong>üìÖ Listed On:</strong>
                            <span>${room.dateAdded}</span>
                        </div>
                    </div>
                    <div class="room-description">
                        <strong>üìù Description:</strong>
                        <p>${room.description}</p>
                    </div>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 20px;">
                        <button class="contact-btn" onclick="contactOwner('${room.contact}', '${room.title}')">
                            üìû Contact Owner
                        </button>
                        <button class="contact-btn" onclick="shareRoom(${room.id})" style="background: linear-gradient(135deg, #6f42c1 0%, #8e44ad 100%);">
                            üì§ Share Room
                        </button>
                        <button class="contact-btn" onclick="viewOnMap('${encodeURIComponent(room.location)}')" style="background: linear-gradient(135deg, #17a2b8 0%, #20c997 100%);">
                            üó∫Ô∏è View Location
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function loadMyRooms() {
            if (!currentUser || currentUser.type !== 'landlord') return;

            const container = document.getElementById('myRoomsContainer');
            const myRooms = rooms.filter(room => room.ownerUsername === currentUser.username);

            if (myRooms.length === 0) {
                container.innerHTML = `
                    <div class="no-rooms">
                        <h3>üìù No rooms added yet</h3>
                        <p>Add your first room using the form above to start earning!</p>
                        <button class="btn" onclick="document.querySelector('.landlord-form').scrollIntoView({behavior: 'smooth'})" style="width: auto; padding: 12px 30px; margin-top: 15px;">
                            ‚ûï Add Your First Room
                        </button>
                    </div>
                `;
                return;
            }

            container.innerHTML = myRooms.map(room => `
                <div class="room-card">
                    <h3>${room.title}</h3>
                    <div class="room-details">
                        <div class="room-detail">
                            <strong>üí∞ Monthly Rent:</strong>
                            <span>‚Çπ${room.rent.toLocaleString()}/month</span>
                        </div>
                        <div class="room-detail">
                            <strong>üìç Location:</strong>
                            <span>${room.location}</span>
                        </div>
                        <div class="room-detail">
                            <strong>üè† Room Type:</strong>
                            <span>${getRoomTypeDisplay(room.roomType)}</span>
                        </div>
                        <div class="room-detail">
                            <strong>üìû Contact:</strong>
                            <span>${room.contact}</span>
                        </div>
                        <div class="room-detail">
                            <strong>‚ú® Amenities:</strong>
                            <span>${room.amenities || 'Basic facilities'}</span>
                        </div>
                        <div class="room-detail">
                            <strong>üìÖ Listed On:</strong>
                            <span>${room.dateAdded}</span>
                        </div>
                    </div>
                    <div class="room-description">
                        <strong>üìù Description:</strong>
                        <p>${room.description}</p>
                    </div>
                    <div class="room-actions">
                        <button class="edit-btn" onclick="editRoom(${room.id})">
                            ‚úèÔ∏è Edit Room
                        </button>
                        <button class="delete-btn" onclick="deleteRoom(${room.id})">
                            üóëÔ∏è Delete Room
                        </button>
                        <button class="contact-btn" onclick="shareRoom(${room.id})" style="background: linear-gradient(135deg, #6f42c1 0%, #8e44ad 100%);">
                            üì§ Share Room
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function getRoomTypeDisplay(type) {
            const types = {
                'single': 'Single Room',
                'sharing': 'Sharing Room',
                '1bhk': '1BHK Apartment',
                '2bhk': '2BHK Apartment',
                '3bhk': '3BHK Apartment'
            };
            return types[type] || type;
        }

        function searchRooms() {
            const location = document.getElementById('searchLocation').value.toLowerCase().trim();
            const maxRent = document.getElementById('maxRent').value;
            const roomType = document.getElementById('roomTypeFilter').value;

            let filteredRooms = [...rooms];
            let searchTerms = [];

            if (location) {
                filteredRooms = filteredRooms.filter(room =>
                    room.location.toLowerCase().includes(location) ||
                    room.title.toLowerCase().includes(location) ||
                    room.description.toLowerCase().includes(location)
                );
                searchTerms.push(`Location: ${location}`);
            }

            if (maxRent && !isNaN(maxRent)) {
                filteredRooms = filteredRooms.filter(room =>
                    room.rent <= parseInt(maxRent)
                );
                searchTerms.push(`Max Rent: ‚Çπ${parseInt(maxRent).toLocaleString()}`);
            }

            if (roomType) {
                filteredRooms = filteredRooms.filter(room =>
                    room.roomType === roomType
                );
                searchTerms.push(`Type: ${getRoomTypeDisplay(roomType)}`);
            }

            lastSearch = searchTerms.join(', ') || 'General search';

            displayRooms(filteredRooms);
            updateDashboard();

            if (filteredRooms.length === 0) {
                showMessage('üòï No rooms found matching your criteria. Try different filters.', true);
                document.getElementById('roomCount').textContent = 'üîç 0 rooms found';
            } else {
                document.getElementById('roomCount').textContent = `üéØ ${filteredRooms.length} rooms found matching your search`;
                showMessage(`‚úÖ Found ${filteredRooms.length} rooms matching your criteria!`);
            }
        }

        function clearFilters() {
            document.getElementById('searchLocation').value = '';
            document.getElementById('maxRent').value = '';
            document.getElementById('roomTypeFilter').value = '';

            displayRooms();
            updateRoomCount();
            showMessage('üóëÔ∏è All filters cleared! Showing all rooms.');
        }

        function showAllRooms() {
            clearFilters();
            displayRooms();
            updateRoomCount();
            showMessage('üìã Showing all available rooms in Lucknow!');
        }

        function quickFilter(type) {
            clearFilters();

            switch (type) {
                case 'budget':
                    document.getElementById('maxRent').value = '10000';
                    lastSearch = 'Budget Friendly (Under ‚Çπ10,000)';
                    break;
                case 'premium':
                    document.getElementById('searchLocation').value = 'gomti nagar';
                    lastSearch = 'Premium (Gomti Nagar Area)';
                    break;
                case 'sharing':
                    document.getElementById('roomTypeFilter').value = 'sharing';
                    lastSearch = 'Sharing Rooms';
                    break;
                case 'single':
                    document.getElementById('roomTypeFilter').value = 'single';
                    lastSearch = 'Single Rooms';
                    break;
                case 'students':
                    document.getElementById('searchLocation').value = 'indira nagar';
                    lastSearch = 'Student Areas';
                    break;
            }

            searchRooms();
        }

        function contactOwner(contact, title) {
            const message = `Hello! I found your room listing "${title}" on Room Finder app. I am interested and would like to know more details. Please share availability and visiting time. Thank you!`;
            const whatsappUrl = `https://wa.me/91${contact}?text=${encodeURIComponent(message)}`;

            if (confirm(`üìû Contact Owner:\n\nPhone: ${contact}\n\nüí¨ Send WhatsApp message with inquiry?`)) {
                window.open(whatsappUrl, '_blank');
                showMessage('üì± WhatsApp opened! Message sent to owner.');
            }
        }

        function shareRoom(roomId) {
            const room = rooms.find(r => r.id === roomId);
            if (!room) return;

            const shareText = `üè† ${room.title}

üí∞ Rent: ‚Çπ${room.rent.toLocaleString()}/month
üè† Type: ${getRoomTypeDisplay(room.roomType)}
üìç Location: ${room.location}
‚ú® Amenities: ${room.amenities}

üìû Contact: ${room.contact}

Found on Room Finder App - Lucknow's Best Room Search Platform!`;

            if (navigator.share) {
                navigator.share({
                    title: room.title,
                    text: shareText,
                    url: window.location.href
                }).then(() => {
                    showMessage('üì§ Room details shared successfully!');
                });
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    showMessage('üìã Room details copied to clipboard! You can paste and share.');
                }).catch(() => {
                    // Fallback for older browsers
                    const textArea = document.createElement('textarea');
                    textArea.value = shareText;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    showMessage('üìã Room details copied! You can paste and share.');
                });
            }
        }

        function viewOnMap(location) {
            const googleMapsUrl = `https://www.google.com/maps/search/${encodeURIComponent(location + ', Lucknow')}`;
            window.open(googleMapsUrl, '_blank');
            showMessage('üó∫Ô∏è Opening location on Google Maps...');
        }

        function editRoom(roomId) {
            const room = rooms.find(r => r.id === roomId);
            if (!room || room.ownerUsername !== currentUser.username) {
                showMessage('‚ùå You can only edit your own rooms.', true);
                return;
            }

            editingRoomId = roomId;

            // Fill form with room data
            document.querySelector('input[name="title"]').value = room.title;
            document.querySelector('input[name="rent"]').value = room.rent;
            document.querySelector('select[name="roomType"]').value = room.roomType;
            document.querySelector('input[name="contact"]').value = room.contact;
            document.querySelector('input[name="location"]').value = room.location;
            document.querySelector('input[name="amenities"]').value = room.amenities || '';
            document.querySelector('textarea[name="description"]').value = room.description;

            document.getElementById('formButtonText').textContent = 'üîÑ Update Room';
            document.getElementById('formTitle').textContent = '‚úèÔ∏è Edit Room Details';

            // Scroll to form
            document.querySelector('.landlord-form').scrollIntoView({ behavior: 'smooth' });
            showMessage('‚úèÔ∏è Room data loaded for editing. Make changes and click update.');
        }

        function deleteRoom(roomId) {
            const room = rooms.find(r => r.id === roomId);
            if (!room || room.ownerUsername !== currentUser.username) {
                showMessage('‚ùå You can only delete your own rooms.', true);
                return;
            }

            if (confirm(`üóëÔ∏è Are you sure you want to delete "${room.title}"?\n\nThis action cannot be undone and the room will be permanently removed from listings.`)) {
                rooms = rooms.filter(r => r.id !== roomId);
                loadMyRooms();
                updateRoomCount();
                updateDashboard();
                showMessage('‚úÖ Room deleted successfully from your listings.');

                if (editingRoomId === roomId) {
                    document.getElementById('roomForm').reset();
                    editingRoomId = null;
                    document.getElementById('formButtonText').textContent = '‚úÖ Add Room';
                    document.getElementById('formTitle').textContent = '‚ûï Add New Room';
                }
            }
        }

        // Form submission handler
        document.getElementById('roomForm').addEventListener('submit', function (e) {
            e.preventDefault();

            if (!currentUser || currentUser.type !== 'landlord') {
                showMessage('‚ùå Only landlords can add/edit rooms.', true);
                return;
            }

            const formData = new FormData(this);

            // Get and validate form data
            const title = formData.get('title').trim();
            const rent = formData.get('rent');
            const roomType = formData.get('roomType');
            const contact = formData.get('contact').trim();
            const location = formData.get('location').trim();
            const description = formData.get('description').trim();
            const amenities = formData.get('amenities').trim();

            // Comprehensive validation
            if (!title || title.length < 10) {
                showMessage('‚ùå Room title should be at least 10 characters long and descriptive.', true);
                return;
            }

            if (!rent || rent < 1000 || rent > 100000) {
                showMessage('‚ùå Rent should be between ‚Çπ1,000 and ‚Çπ1,00,000.', true);
                return;
            }

            if (!roomType) {
                showMessage('‚ùå Please select a room type.', true);
                return;
            }

            if (!contact || !/^\d{10}$/.test(contact)) {
                showMessage('‚ùå Contact number should be exactly 10 digits.', true);
                return;
            }

            if (!location || location.length < 15) {
                showMessage('‚ùå Location should be detailed (at least 15 characters) including area and city.', true);
                return;
            }

            if (!description || description.length < 50) {
                showMessage('‚ùå Description should be detailed (at least 50 characters) to attract tenants.', true);
                return;
            }

            const roomData = {
                id: editingRoomId || Date.now(),
                title: title,
                rent: parseInt(rent),
                location: location,
                roomType: roomType,
                contact: contact,
                amenities: amenities || 'Basic facilities available',
                description: description,
                ownerUsername: currentUser.username,
                dateAdded: editingRoomId ? rooms.find(r => r.id === editingRoomId).dateAdded : new Date().toLocaleDateString('en-IN')
            };

            if (editingRoomId) {
                // Update existing room
                const index = rooms.findIndex(r => r.id === editingRoomId);
                if (index !== -1) {
                    rooms[index] = roomData;
                    showMessage('‚úÖ Room updated successfully! Your changes are now live.');
                }
                editingRoomId = null;
                document.getElementById('formButtonText').textContent = '‚úÖ Add Room';
                document.getElementById('formTitle').textContent = '‚ûï Add New Room';
            } else {
                // Add new room
                rooms.push(roomData);
                showMessage('üéâ New room added successfully! It\'s now visible to all students.');
            }

            // Reset form and refresh displays
            this.reset();
            loadMyRooms();
            updateRoomCount();
            updateDashboard();

            // If student tab is active, refresh room display
            if (document.getElementById('studentSection').style.display !== 'none') {
                displayRooms();
            }
        });

        function showMessage(message, isError = false) {
            const successEl = document.getElementById('successMessage');
            const errorEl = document.getElementById('errorMessage');

            // Hide any existing messages
            successEl.style.display = 'none';
            errorEl.style.display = 'none';

            if (isError) {
                errorEl.textContent = message;
                errorEl.style.display = 'block';
                // Scroll to message
                errorEl.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            } else {
                successEl.textContent = message;
                successEl.style.display = 'block';
                // Scroll to message
                successEl.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }

            // Auto hide after 6 seconds
            setTimeout(() => {
                successEl.style.display = 'none';
                errorEl.style.display = 'none';
            }, 6000);
        }

        // Additional utility functions
        function formatRent(rent) {
            return new Intl.NumberFormat('en-IN', {
                style: 'currency',
                currency: 'INR',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(rent);
        }

        function getTimeAgo(dateStr) {
            const date = new Date(dateStr);
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

            if (diffDays === 0) return 'Today';
            if (diffDays === 1) return 'Yesterday';
            if (diffDays < 7) return `${diffDays} days ago`;
            if (diffDays < 30) return `${Math.floor(diffDays / 7)} weeks ago`;
            return dateStr;
        }

        // Enhanced search with sorting
        function sortRooms(criteria) {
            let sortedRooms = [...rooms];

            switch (criteria) {
                case 'rent-low':
                    sortedRooms.sort((a, b) => a.rent - b.rent);
                    break;
                case 'rent-high':
                    sortedRooms.sort((a, b) => b.rent - a.rent);
                    break;
                case 'date-new':
                    sortedRooms.sort((a, b) => new Date(b.dateAdded) - new Date(a.dateAdded));
                    break;
                case 'date-old':
                    sortedRooms.sort((a, b) => new Date(a.dateAdded) - new Date(b.dateAdded));
                    break;
                default:
                    break;
            }

            displayRooms(sortedRooms);
            showMessage(`üîÑ Rooms sorted by ${criteria.replace('-', ' ')}`);
        }

        // Initialize demo data message
        setTimeout(() => {
            if (!currentUser) {
                console.log('Demo data loaded: ', rooms.length, 'rooms available');
            }
        }, 1000);

        // Add keyboard shortcuts
        document.addEventListener('keydown', function (e) {
            // Ctrl/Cmd + K for search focus
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                if (currentUser && currentUser.type === 'student') {
                    document.getElementById('searchLocation').focus();
                }
            }

            // Escape key to clear messages
            if (e.key === 'Escape') {
                document.getElementById('successMessage').style.display = 'none';
                document.getElementById('errorMessage').style.display = 'none';
            }
        });

        // Add mobile-friendly touch events
        if ('ontouchstart' in window) {
            document.body.classList.add('touch-device');
        }

        // Service worker for offline functionality (basic)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function () {
                console.log('Service Worker support detected');
            });
        }
    </script>
</body>

</html>